<div class="container">
  <div class="row col-12 col-lg-10 mx-auto mb-5">
    <div class="d-flex justify-content-between col-12 mt-4 align-items-center">
      <h1 class="pb-0 mb-2 heading-white-bg">Discover</h1>
        <% if (!currentUserDiscovered) { %>
        <a href="/discover/<%=currentUser.id%>/settings" class="btn btn-primary px-4 py-2">Get Discovered</a>
        <% } %>
    </div>

    <% if (filteredUsersCount != 0 || filteredUsersCount > 0) { %>
    <div class="tinder">
      <div class="tinder--status">
        <i class="fa fa-remove swipe-reject"></i>
        <i class="fa fa-fire-flame-curved swipe-like"></i>
      </div>



      <div class="tinder--cards">

        <div class="d-none mx-auto my-auto" id="out-of-cards">
          <p >No users available at this time.</p>
          <p>Check back later.</p>
        </div>


        <% discoverableUsers.forEach(function(discoverableUser) { %>

          <% if(discoverableUser.user._id != currentUser.id && !currentUser.following.includes(discoverableUser.user._id) && !currentUser.rejected.includes(discoverableUser.user._id) && !discoverableUser.discover.img1 == '') { %>
            <div class="tinder--card" data-user-id="<%= discoverableUser.user._id %>">
              <!-- <img src="/uploads/flame.PNG"> -->

              <div id="carouselExampleControls" class="carousel slide" data-bs-ride="true" >
                <div class="carousel-inner">

                  <div class="carousel-item active">
                    <img src="/uploads/<%= discoverableUser.discover.img1 %>" class="d-block w-100 discover-img" onerror="this.onerror=null; this.src='/uploads/flame.PNG';" alt="<%= discoverableUser.user.username %>">
                  </div>

                  <% if (!discoverableUser.discover.img2 == '') {%>
                    <div class="carousel-item">
                      <img src="/uploads/<%= discoverableUser.discover.img2 %>" class="d-block w-100 discover-img" onerror="this.onerror=null; this.src='/uploads/flame.PNG';" alt="<%= discoverableUser.user.username %>">
                    </div>
                  <% } %>

                  <% if (!discoverableUser.discover.img3 == '') {%>
                    <div class="carousel-item">
                      <img src="/uploads/<%= discoverableUser.discover.img3 %>" class="d-block w-100 discover-img" onerror="this.onerror=null; this.src='/uploads/flame.PNG';" alt="<%= discoverableUser.user.username %>">
                    </div>
                  <% } %>

                  <% if (!discoverableUser.discover.img4 == '') {%>
                    <div class="carousel-item">
                      <img src="/uploads/<%= discoverableUser.discover.img4 %>" class="d-block w-100 discover-img" onerror="this.onerror=null; this.src='/uploads/flame.PNG';" alt="<%= discoverableUser.user.username %>">
                    </div>
                  <% } %>

                  <% if (!discoverableUser.discover.img5 == '') {%>
                    <div class="carousel-item">
                      <img src="/uploads/<%= discoverableUser.discover.img5 %>" class="d-block w-100 discover-img" onerror="this.onerror=null; this.src='/uploads/flame.PNG';" alt="<%= discoverableUser.user.username %>">
                    </div>
                  <% } %>

                  <% if (!discoverableUser.discover.img6 == '') {%>
                    <div class="carousel-item">
                      <img src="/uploads/<%= discoverableUser.discover.img6 %>" class="d-block w-100 discover-img" onerror="this.onerror=null; this.src='/uploads/flame.PNG';" alt="<%= discoverableUser.user.username %>">
                    </div>
                  <% } %>
                  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                  </button>





                  </div>
                </div>



              <div class="d-flex col-12 discover-div ">
                <div class="d-flex col-11 my-1 mx-auto py-1 justify-content-between align-items-center">
                  <div class="">
                    <h5 class="d-flex col-8 mb-0"><%= discoverableUser.user.displayName %></h5>
                    <h6 class="mb-0">@<%= discoverableUser.user.username %></h6>
                  </div>
                  <p class="discover-diet px-2 d-flex mb-0"><%= discoverableUser.discover.diet %></p>
                </div>

              </div>
              <p class="d-flex col-11 mx-auto text-break my-2 fs-6 text-start"><%= discoverableUser.discover.desc %></p>

            </div>
          <% } else { %>
            <% console.log("Skipped user, id: " + discoverableUser.user._id); %>
          <% } %>

      <% }); %>
      </div>


      <div class="tinder--buttons">
        <button id="nope"><i class="fa fa-remove swipe-reject"></i></button>
        <button id="love"><i class="fa fa-fire-flame-curved swipe-like"></i></button>
      </div>

      <% } else { %>
        <p class="py-5 text-center text-dark position-relative z-3">No users to discover at this time, check back later!</p>
      <% } %>
    </div>



  </div>
</div>
